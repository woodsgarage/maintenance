<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Maintenance</title>
  <link rel="stylesheet" href="style.css">
  <script src="app.js"></script>
  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycby6ebYaX33JVaysalB1JHmNmgywk6V7l6OFGvFuZ7Oe7BpZ_qiChnPAmbt68NEHazO7Fw/exec";

    async function submitMaintenance(e) {
      e.preventDefault();
      const vin = getQueryParam("vin");
      if (!vin) { alert("VIN missing"); return; }

      const data = {
        vin: vin.toString().trim(),
        odometer: document.getElementById("odometer").value,
        service: document.getElementById("service").value,
        parts: document.getElementById("parts").value,
        notes: document.getElementById("notes").value
      };

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          body: JSON.stringify(data)
        });
        const result = await res.json();
        if (result.status === "success") {
          alert("Maintenance added!");
          document.getElementById("maintenanceForm").reset();
        } else alert("Error adding maintenance");
      } catch(err) {
        console.error(err); alert("Error adding maintenance");
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("maintenanceForm").addEventListener("submit", submitMaintenance);
    });
  </script>
</head>
<body>
  <header>Add Maintenance</header>
  <main>
    <form id="maintenanceForm">
      <label>Odometer Reading:<input type="number" id="odometer" required></label>
      <label>Service:<input type="text" id="service" required></label>
      <label>Parts:<input type="text" id="parts"></label>
      <label>Notes:<textarea id="notes"></textarea></label>
      <button type="submit">Add Maintenance</button>
    </form>
  </main>
  <footer>&copy; 2026 Woods Garage</footer>
</body>
</html>
